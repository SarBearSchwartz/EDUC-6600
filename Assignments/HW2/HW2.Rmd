---
title: "Psy/Educ 6600: Unit 2 Homework"
subtitle: "Groundwork for Inference"
author: "Your Name"
date: "Spring 2018"
output: 
  pdf_document:
    latex_engine: xelatex
    toc: true
    toc_depth: 3
    number_sections: false
---


\clearpage

# PREPARATION



```{r oppts, include=FALSE}
# set global chunk options...  
#  this changes the defaults so you don't have to repeat yourself
knitr::opts_chunk$set(comment     = NA,
                      cache       = TRUE,
                      echo        = TRUE, 
                      warning     = FALSE, 
                      message     = FALSE,
                      fig.align   = "center", # center all figures
                      fig.width   = 6,        # set default figure width to 4 inches
                      fig.height  = 4)        # set default figure height to 3 inches

```

## Load Packages

* Make sure the packages are **installed** *(Package tab)*

```{r libraries}
library(tidyverse)    # Loads several very helpful 'tidy' packages
library(readxl)       # Read in Excel datasets
library(furniture)    # Nice tables (by our own Tyson Barrett)
```

## Ihno's Dataset for Section C's

Import Data, Define Factors, and Compute New Variables

* Make sure the **dataset** is saved in the same *folder* as this file
* Make sure the that *folder* is the **working directory**

> NOTE: I added the second line to convert all the variables names to lower case.  I still kept the `F` as a capital letter at the end of the five factor variables.

```{r ihno}
data_clean <- read_excel("Ihno_dataset.xls") %>% 
  dplyr::rename_all(tolower) %>% 
  dplyr::mutate(genderF = factor(gender, 
                                 levels = c(1, 2),
                                 labels = c("Female", 
                                            "Male"))) %>% 
  dplyr::mutate(majorF = factor(major, 
                                levels = c(1, 2, 3, 4,5),
                                labels = c("Psychology",
                                           "Premed",
                                           "Biology",
                                           "Sociology",
                                           "Economics"))) %>% 
  dplyr::mutate(reasonF = factor(reason,
                                 levels = c(1, 2, 3),
                                 labels = c("Program requirement",
                                            "Personal interest",
                                            "Advisor recommendation"))) %>% 
  dplyr::mutate(exp_condF = factor(exp_cond,
                                   levels = c(1, 2, 3, 4),
                                   labels = c("Easy",
                                              "Moderate",
                                              "Difficult",
                                              "Impossible"))) %>% 
  dplyr::mutate(coffeeF = factor(coffee,
                                 levels = c(0, 1),
                                 labels = c("Not a regular coffee drinker",
                                            "Regularly drinks coffee")))  %>% 
  dplyr::mutate(hr_base_bps = hr_base / 60) %>% 
  dplyr::mutate(anx_plus = rowsums(anx_base, anx_pre, anx_post)) %>% 
  dplyr::mutate(hr_avg = rowmeans(hr_base, hr_pre, hr_post)) %>% 
  dplyr::mutate(statDiff = statquiz - exp_sqz)
```



\clearpage

## Other Datasets for Section B's

```{r data}
schizo <- data.frame(id = c(1:10),
                     yr_hos = c(5, 7, 12, 5, 11, 3, 7, 2, 9, 6),
                     ori_test = c(22, 26, 16, 20, 18, 30, 14, 24, 15, 19))

GRE <- data.frame(id = c(1:5),
                  verbalGRE_1 = c(540, 510, 580, 550, 520),
                  verbalGRE_2 = c(570, 520, 600, 530, 520))

test_scores <-  data.frame(id = c(1:12),
                           spatial = c(13, 32, 41, 26, 28, 12, 19, 33, 24, 46, 22, 17),
                           math = c(19, 25, 31, 18, 37, 16, 14, 28, 20, 39, 21, 15))

child_vars  <-  data.frame(child = c(1:8),
                           shoe = c(5.2, 4.7, 7.0, 5.8, 7.2, 6.9, 7.7, 8.0),
                           read = c(1.7, 1.5, 2.7, 3.1, 3.9, 4.5, 5.1, 7.4),
                           age = c(5, 6, 7, 8, 9, 10, 11, 12))

memory <- data.frame(id = c(1:9),
                     sound = c(8, 5, 6, 10, 3, 4, 7, 11, 9),
                     look = c(4, 5, 3, 11, 2, 6, 4, 6, 7))
data_wait <- data.frame(child = c(10, 12, 15, 11,  5,  7,  2),
                        woman = c(17, 13, 16, 12,  7,  8,  3),
                        man   = c(20, 25, 14, 17, 12, 18,  7))

data_food <- data.frame(green = c(3, 7, 1, 0, 9, 2),
                        red   = c(3, 4, 5, 6, 4, 6),
                        blue  = c(2, 0, 4, 6, 4, 1))

data_undergrad <- data.frame(class      = c( 1,  1,  1,  1,  
                                             2,  2,  2,  2,
                                             3,  3,  3,  3,  
                                             4,  4,  4,  4),
                             humanities = c( 2,  4,  3,  7,  
                                             3,  4,  6,  5,  
                                             7,  8,  7,  7, 
                                            10, 12,  9, 13),
                             science    = c( 5,  6,  9, 10, 
                                            10, 12, 16, 14, 
                                            14, 15, 13, 12, 
                                            16, 18, 16, 19),
                             business   = c( 7,  8,  7, 12, 
                                            20, 13, 16, 15, 
                                            20, 25, 22, 21, 
                                            30, 33, 34, 29))

data_memory <- data.frame(incidental_agree     = c(8, 7, 7, 9, 4),
                          incidental_disagree  = c(2, 3, 2, 4, 4),
                          intentional_agree    = c(6, 8, 9, 5, 8),
                          intentional_disagree = c(7, 9, 8, 5, 7))
```


\clearpage

# Chapter 7. Independent Samples `t`-Test for Means

## 7C-1. Independent Samples `t`-Test for Mean `hr_base` by `genderF`

**TEXTBOOK QUESTION:**  *Perform a two-sample t test to determine whether there is a statistically significant difference in **baseline heart rate** between the **men and the women** of Inho's class. Do you have **homogeneity of variance**? Report your results as they might appear in a journal article. Include the 95% CI for this gender difference.*

### Assumtion Check: Homogeneity of Variance

**DIRECTIONS:** Before performing the test, check to see if the assumption of homogeneity of variance is met using **Levene's Test**.  For a independent samples `t`-test for means, the men and women need to have the same amount of spread (SD) in their baseline hear rates.

 > **NOTE:** Use the `car:leveneTest()` function to do this.  Inside the funtion you need to specify at least three things (sepearated by commas):

> * the formula:  `continuous_var ~ grouping_var` (replace with your variable names)

> * the dataset:  `data = .` to pipe it from above

> * the center:  `center = "mean"` since we are comparing means

```{r}

```


\clearpage

### Perform the `t`-Test for Means in 2 Indep Groups 

**DIRECTIONS:** Test if men and women have different baseline heart rates using the `t.test()` function.

>Use the same `t.test()` funtion we have used in the prior chapters.  This time you need to speficy a few more options:

> * the formula:  `continuous_var ~ grouping_var` (replace with your variable names)

> * the dataset:  `data = .` to pipe it from above

> * independent vs. paired:  `paired = FALSE` (this is the default)

> * is homogeneity satified: `var.equal = TRUE` (NOT the default)

> * confidence level: `conf.level = #` (defults to .95)


```{r}
# indep groups t-test for means: hr_base by genderF

```






\clearpage

## 7C-5. Independent Samples `t`-Test for Mean `hr_post` by `coffeeF`

**TEXTBOOK QUESTIONS:** *Perform a two-sample t test to determine whether **coffee drinkers** exhibited significantly higher **postquiz heart rates** than nondrinkers at the .05 level. Is this t test significant at the .01 level? Find the **99%** confidence interval for the difference of the two population means and explain its connection to your decision regarding the null hypothesis at the **.01 level**.*


### Assumtion Check: Homogeneity of Variance

**DIRECTIONS:** Just like the last question, run **Levene's test** first.

```{r}

```

### Perform the `t`-Test for Means in 2 Indep Groups 

**DIRECTIONS:** Make sure to change the confidence level to **99%**.

```{r}
# indep groups t-test for means: hr_post by coffeeF

```



## Chapter 8

No R for Chapter 8.


\clearpage

# SECTION B ITEMS


## Chapter 12. ANOVA


### 12B-4 Introduce One-Way ANOVA

**TEXTBOOK QUESTION:** *A social psychologist wants to know how long people will wait before responding to cries for help from an unknown person and whether the gender or age of the person in need of help makes any difference. One at a time, subjects sit in a room waiting to be called for an experiment. After a few minutes they hear cries for help from the next room, which are actually on a tape recording. The cries are in either an adult male's, an adult female's, or a child's voice; seven subjects are randomly assigned to each condition. The dependent variable is the number of seconds from the time the cries begin until the subject gets up to investigate or help.  (a) Calculate the F ratio. (b) Find the critical F ($\alpha = .05$). (c) What is your statistical conclusion? (d) Present the results of the ANOVA in a summary table. (e) Calculate $\eta^2$ using Formula 12.10. *


```{r Q12b4_data}
# Display the raw dataset: wide format
data_wait
```


First, the data must be restructured from **wide** to **long** format, so that each observation is on its own line.  All categorical variables must be declared as fators.  We also must add an distinct indicator variable.  

```{r Q12b4_restructure}
# convert the dataset: wide --> long
data_wait_long <- data_wait %>% 
  tidyr::gather(key = caller_type,                 # new var name = groups
                value = delay_time,                # new var name = measurements
                child, woman, man) %>%             # all old variable names
  dplyr::mutate(id = row_number()) %>%             # create a sequential id variable
  dplyr::select(id, caller_type, delay_time) %>%   # reorder the variables
  dplyr::mutate_at(vars(id, caller_type), factor)  # declare factors

data_wait_long %>% head(n = 10)                    # display the top 10 rows only
```

\clearpage

Second, check the summary statistics for each group.

```{r Q12b4_summary, results="asis"}
# Raw data: summary table
data_wait_long %>% 
  dplyr::group_by(caller_type) %>%          # divide into groups
  furniture::table1(delay_time,             # gives M(SD)
                    output = "markdown")    # add chunk option: results="asis"
```


Third, plot the data to eyeball the potential effect.  Remember the center line in each box represents the median, not the mean.

```{r Q12b4_boxplot, fig.width=4, fig.height=2}
# Raw data: boxplots
data_wait_long %>% 
  ggplot(aes(x = caller_type,
             y = delay_time)) + 
  geom_boxplot() +
  geom_point() 
```


```{r Q12b4_plot, fig.width=4, fig.height=2}
# Raw data: plot M(SD)
data_wait_long %>% 
  ggplot(aes(x = caller_type,
             y = delay_time)) + 
  stat_summary() 
```


\clearpage

### Tutorial - Fitting One-way ANOVA Models with `afex::aov_4()`

The `aov_4()` function from the `afex` package fits ANOVA models (oneway, two-way, repeated measures, and mixed design). It needs at least two arguments:

1. formula:  `continuous_var ~ group_var + (1|id_var)`  *one observation per subject and `id_var` is distinct for each subject*

2. dataset: `data = .` *we use the period to signify that the datset is being piped from above*


Here is an outline of what your syntax should look like when you **fit and save a one-way ANOVA**.  Of course you will replace the dataset name and the variable names, as well as the name you are saving it as.

> **NOTE:** The `aov_4()` function works on data in LONG format only.  Each observation needs to be on its one line or row with seperate variables for the group membership (categorical factor or `fct`) and the continuous measurement (numberic or `dbl`).

```{r EX_aov_4, eval=FALSE}
# One-way ANOVA: fit and save
aov_name <- data_name %>% 
  afex::aov_4(continuous_var ~ group_var + (1|id_var),
              data = .)
```


------------------------------

By running the name you saved you model under, you will get a brief set of output, including a measure of **Effect Size**.

> **NOTE:** The `ges` is the *generalized eta squared*.  In a one-way ANOVA, the eta-squared effect size is the same value, ie. generalized $\eta_g$ and partial $\eta_p$ are the same.

```{r EX_aov_4_brief, eval=FALSE}
# Display basic ANOVA results (includes effect size)
aov_name 
```


------------------------------

To fully fill out a standard ANOVA table and compute other effect sizes, you will need a more complete set of output, including the **Sum of Squares** components, you will need to add `$Anova` at the end of the model name before running it.

> **NOTE:** IGNORE the first line that starts with `(Intercept)`!  Also, the 'mean sum of squares' are not included in this table, nor is the **Total** line at the bottom of the standard ANOVA table.  You will need to manually compute these values and add them on the homework page.  Remember that `Sum of Squares (SS)` and `degrees of freedom (df)` add up, but `Mean Sum of Squreas (MS)` do not add up.  Also: `MS = SS/df` for each term.


```{r EX_aov_4_fuller, eval=FALSE}
# Display fuller ANOVA results (includes sum of squares)
aov_name$Anova 
```

\clearpage

**DIRECTIONS:** Fit an one-way ANOVA model for the differences in mean `wait_time` for each of the three independent `caller_type` groups with the `afex::aov_4()` function and save the results under the name `aov_wait_time`.

```{r Q12b4_model}
# One-way ANOVA: fit and save

```

Remember, since you are saving your model to a name *(`aov_wait_time`)*, there will not be any output, except a message about setting contrasts to `contr.sum`.

-------------------------


**DIRECTIONS:** Request the omnibus $F$ value by typing the name you saved your fitted model as above (`aov_wait_time`).  This time you need only remove the pound symbol at the start of the line in the code chunk below.


```{r Q12b4_results}
# Display basic ANOVA results (includes effect size)
#aov_wait_time 
```


------------------------------------------

**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above.  This time you need only remove the pound symbol at the start of the line in the code chunk below.


```{r Q12b4c_table}
# Display fuller ANOVA results (includes sum of squares)
#aov_wait_time$Anova
```

\clearpage








### 12B-5 Another One-Way ANOVA


**TEXTBOOK QUESTION:** *A psychologist is interested in the relationship between color of food and appetite. To explore this relationship, the researcher bakes small cookies with icing of one of three different colors (green, red, or blue). The researcher offers cookies to subjects while they are performing a boring task.  Each subject is run individually under the same conditions, except for the color of the icing on the cookies that are available. Six subjects are randomly assigned to each color. The number of cookies consumed by each subject during the 30-minute session is shown in the following table.  (a) Calculate the F ratio. (b) Find the critical F ($\alpha = .01$). (c) What is your statistical decision with respect to the null hypothesis? (d) Present your results in the form of a summary table.*


```{r Q12b5_data}
# Display the raw dataset: wide format
data_food
```

First, the data must be restructured from **wide** to **long** format, so that each observation is on its own line.  All categorical variables must be declared as fators.  We also must add an distinct indicator variable.  

```{r Q12b5_restructure}
# convert the dataset: wide --> long
data_food_long <- data_food %>% 
  tidyr::gather(key = icing_color,                 # new var name = groups
                value = cookies_ate,               # new var name = measurements
                green, red, blue) %>%              # all old variable names
  dplyr::mutate(id = row_number()) %>%             # create a sequential id variable
  dplyr::select(id, icing_color, cookies_ate) %>%  # reorder the variables
  dplyr::mutate_at(vars(id, icing_color), factor)  # declare factors

data_food_long %>% head(n = 10)
```


\clearpage


**DIRECTIONS:** Request the summary statistics for each group using the `table1()` function from the `furniture` package, after piping a `dplyr::group_by(group_var)` step.

```{r Q12b5_summary, results="asis"}

```

------------------------------------------

**DIRECTIONS:** Plot the raw data for each group using the `stat_summary()` layer in `ggplot(aes(x = group_var, y = contin_var))`.

```{r Q12b5_plot}
# Raw data: plot M(SD)'s

```

\clearpage

**DIRECTIONS:** Fit an one-way ANOVA model for the difference in mean `cookies_ate` for each of the three independent `icing_color` groups with the `afex::aov_4()` function and save the results under the name `aov_food_time`.


```{r Q12b5_aov}
# One-way ANOVA: fit and save

```

------------------------------------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  


```{r Q12b5_aov_basic}
# Display basic ANOVA results (includes effect size)

```

------------------------------------------

**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above. 


```{r Q12b5_aov_fuller}
# Display fuller ANOVA results (includes sum of squares)
 
```

\clearpage

### 12B-6 The Effect of Larger Mean Values 


**TEXTBOOK QUESTION:** *Suppose that the data in Exercise 5 had turned out differently. In particular, suppose that the number of cookies eaten by subjects in the green condition remains the same, but each subject in the red condition ate 10 more cookies than in the previous data set, and each subject in the blue condition ate 20 more.  (a) Calculate the F ratio. Is the new F ratio significant at the .01 level? (b) Which part of the F ratio has changed from the previous exercise and which part has remained the same? (c) Put your results in a summary table to facilitate comparison with the results of Exercise 5. (d) Calculate estimated $\omega^2$ with Formula 12.12 and adjusted $\eta^2$ with Formula 12.14. Are they the same? Explain.*


BEFORE you restructured from **wide** to **long** format, abb 10 to the red counts and add 20 to the blue counts.

```{r Q12b6_restructure}
# Revised wide dataset
data_food_long2 <- data_food %>% 
  dplyr::mutate(red   = 10 + red) %>%              # NEW VALUES = 10 + OLD !!!
  dplyr::mutate(blue  = 20 + blue) %>%             # NEW VALUES = 20 + OLD !!!
  tidyr::gather(key = icing_color,                 # new var name = groups
                value = cookies_ate,               # new var name = measurements
                green, red, blue) %>%              # all old variable names
  dplyr::mutate(id = row_number()) %>%             # create a sequential id variable
  dplyr::select(id, icing_color, cookies_ate) %>%  # reorder the variables
  dplyr::mutate_at(vars(id, icing_color), factor)  # declare factors

data_food_long2 %>% head(n = 10)
```

\clearpage

**DIRECTIONS:** Request the summary statistics for each group using the `table1()` function from the `furniture` package, after piping a `dplyr::group_by(group_var)` step.

```{r Q12b6_summary, results="asis"}
# Raw data: summary table

```


------------------------------------------


**DIRECTIONS:** Plot the raw data for each group using the `stat_summary()` layers in `ggplot(aes(x = group_var, y = contin_var))`.

```{r Q12b6_plot}
# Raw data: plot M(SD)

```


\clearpage

**DIRECTIONS:** Fit an one-way ANOVA model for the difference in mean `cookies_ate` for each of the three independent `icing_color` groups with the `afex::aov_4()` function and save the results under the name `aov_food_time2`.


```{r Q12b6_model}
# One-way ANOVA: fit and save

```

------------------------------------------


**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  


```{r Q12b6_results}
# Display basic ANOVA results (includes effect size)

```


------------------------------------------


**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above. 


```{r Q12b6_table}
# Display fuller ANOVA results (includes sum of squares)

```



\clearpage

## Chapter 14. Two-Way ANOVA

### 14B-7a 3x4 Two ANOVA

**TEXTBOOK QUESTION:** *A college is conducting a study of its students' expectations of employment upon graduation. Students are sampled by class and major area of study and are given a score from 0 to 35 according to their responses to a questionnaire concerning their job preparedness, goal orientation, and so forth. The data appear in the following table.  (a) Perform a two-way ANOVA and create a summary table.*


```{r Q14b7a_restructure}
# convert the dataset: wide --> long
data_undergrad_long <- data_undergrad %>% 
  dplyr::mutate(class = factor(class,
                               levels = c(1, 2, 3, 4),
                               labels = c("Freshmen",
                                          "Sophomores",
                                          "Juniors",
                                          "Seniors"))) %>% 
  tidyr::gather(key = major,
                value = expect_employ,
                humanities, science, business) %>% 
  dplyr::mutate(id = row_number()) %>% 
  dplyr::select(id, class, major, expect_employ)

data_undergrad_long %>% head(n = 12)
```

\clearpage


### Tutorial - Fitting Two-way ANOVA Models with `afex::aov_4()`

The only difference between a one-way and two-way ANOVA's syntax is the inclusion of a second grouping variable in the formula.  

> **NOTE:** The astric (`*`) is used to designate the interaction and main effects between two factors.  `group_var1*group_var2` is short for `group_var1 + group_var2 + group_var1:group_var2`.  The colon (`:`) designates an interaction.

```{r EX_aov_4_2way, eval=FALSE}
# Two-way ANOVA: fit and save
aov_name <- data_name %>% 
  afex::aov_4(continuous_var ~ group_var1*group_var2 + (1|id_var),
              data = .)
```

-----------------------

**DIRECTIONS:** Fit a two-way ANOVA model for the difference in mean `expect_employ` for each of the combinations between the four-level `class` factor and three-level `major` factor with the `afex::aov_4()` function and save the results under the name `aov_employ`.


```{r Q14b7a_aov}
# Two-way ANOVA: fit and save

```

------------------------------------------

**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above.


```{r Q14b7a_aov_fuller}
# Display fuller ANOVA results (includes sum of squares)

```

\clearpage

### 14B-7b Plot Cell Means

**TEXTBOOK QUESTION:** *(B) Draw a graph of the cell means. Does the interaction obscure the interpretation of the main effects?*

### Tutorial - Cell Means: Displaying in a Grid and Plotting

For a two-way ANOVA, we often would like to see a grid of the means for all combinations of the two grouping factors.  This is may be achieved by the following steps:

1. `group_by` - group observations by both of the grouping variables
2. `summarise` - compute the mean of each combination subgroup
3. `spread` -spread the means into a grid pattern

```{r EX_cell_means_grid, eval = FALSE}
# Raw data: 2-way table of means (i.e. cell means)
data_long %>% 
  dplyr::group_by(group_var1, group_var2) %>% 
  dplyr::summarise(mean = mean(continuous_var)) %>% 
  tidyr::spread(key = group_var1, 
                value = mean)
```

--------------------------------

Here is the 3x4 grid of cell means, giving the average for each of the 12 combinations of `class` and `major`.

```{r Q14b7b_means}
# Raw data: 2-way table of means (i.e. cell means)
data_undergrad_long %>% 
  dplyr::group_by(class, major) %>% 
  dplyr::summarise(mean = mean(expect_employ)) %>% 
  tidyr::spread(key = class, 
                value = mean)
```

\clearpage

To incorporated a second grouping variable into the plot, we can use `shape` and/or `color`.  I prefer to use both to ensure that the color distinction is not completely lost when photo coping or if a reader is color blind.

> **NOTE:** The inclusion of `stat_summary(position=position_dodge(width=0.25))` within the `stat_summary()` function causes the points to be slightly offset so that points are not drawn on top of each other.

```{r Q14b7b_plot}
# Raw data: plot M(SD)
data_undergrad_long %>% 
  ggplot(aes(x = class,
             y = expect_employ,
             shape = major,
             color = major)) +
  stat_summary(position=position_dodge(width=0.25))
```


\clearpage

### 14B-7c Pairwise Post Hoc with Tukey's HSD

**TEXTBOOK QUESTION:** *(C) Use Tukey's HSD to determine which pairs of class years differ significantly.*

**DIRECTIONS:** Request the summary statistics for `expect_employ` within each `class` using the `table1()` function from the `furniture` package, after piping a `dplyr::group_by(group_var)` step.


```{r Q14b7c_means, results="asis"}

```

---------------------

**DIRECTIONS:** Plot the raw data for each `class` using the `stat_summary()` layer in `ggplot(aes(x = group_var, y = contin_var))`.

```{r Q14b7c_plot, fig.width=4, fig.height=2.5}
# Raw data: plot M(SD)

```

\clearpage

### Tutorial - Pairwise Post Hoc comparisons for a One-way ANOVA

There are two steps to conduct all possible pairwise comparisons:

1. `emmeans(~ group_var)` - Calculate the *Estimated Marinal Means*
2. `pairs()` - Determine if each pair is *significantly different*

Within the `pairs()` function there are several options for controling for multiple comparisons, including:

* `adjust = "none"` - Fisher's LSD
* `adjust = "tukey"` - Tukey's HSD
* `adjust = "bon"` - Bonferroni


```{r EX_tukey, eval=FALSE}
# Pairwise post hoc: Tukey's HSD adjustment for multiple comparisons
aov_name %>% 
  emmeans::emmeans(~ group_var) %>%        # Calculate Estimated Marinal Means
  pairs(adjust = "tukey")                  # Is each pair signif different?
```



---------------------------

**DIRECTIONS:** Request all pairwise post hoc comparisons via Tukey's HSD with the `adjust = "tukey"` option in the `pairs()` function, applied after piping a `emmeans(~ group_var)` step to the ANOVA model.


```{r Q14b7c_tukey}
# Pairwise post hoc: Tukey's HSD adjustment for multiple comparisons

```


\clearpage

### 14B-7d 2x2 Contrast Statements to Test Extremes

**TEXTBOOK QUESTION:** *For just the freshmen and seniors, calculate the three possible interaction contrasts. Which, if any, would be significant according to Scheffe's test?*

The following code chunk will display the means for all combinations of the two grouping variables so that you can figure out which order to set up the contrast weights ($c_i$'s).

```{r Q14b7d_emmeans}
# Request all emmeans: see ORDER for contrast weights to be entered below
#aov_employ %>% 
#  emmeans::emmeans(~ class*major)
```


```{r Q14b7d_contrast1}
# 2x2 Contrast statement (Freshmen vs. Seniors): Humanities vs. Science
# aov_employ %>% 
#   emmeans::emmeans(~ class*major) %>% 
#   emmeans::contrast(list("fr-sr X Hum-Sc" = c( 0, 0, 0,  0, 
#                                                1, 0, 0, -1, 
#                                               -1, 0, 0,  1)))
```


```{r Q14b7d_contrast2}
# 2x2 Contrast statement (Freshmen vs. Seniors): Humanities vs. Business
# aov_employ %>% 
#   emmeans::emmeans(~ class*major) %>% 
#   emmeans::contrast(list("fr-sr X Hum-bus" = c(1, 0, 0, -1, 
#                                               -1, 0, 0,  1,
#                                                0, 0, 0,  0)))
```


```{r Q14b7d_contrast3}
# 2x2 Contrast statement (Freshmen vs. Seniors): Science vs. Business
# aov_employ %>% 
#   emmeans::emmeans(~ class*major) %>% 
#   emmeans::contrast(list("fr-sr X Hum-bus" = c(1, 0, 0, -1,
#                                                0, 0, 0,  0, 
#                                               -1, 0, 0,  1)))
```


\clearpage


### 14B-8a 2x2 Two-Way ANOVA

**TEXTBOOK QUESTION:** *The data from Exercise 12B8 for a fourgroup experiment on attitudes and memory are reproduced below. Considering the relationships among the four experimental conditions, it should be obvious that it makes sense to analyze these data with a two-way ANOVA.  (A) Perform a two-way ANOVA and create a summary table of your results. (Note : You can use the summary table from Exercise 12B8 as the basis for a new table.)*


```{r Q14b8a_restructure}
# convert the dataset: wide --> long
data_memory_long <- data_memory %>% 
  tidyr::gather(key = warning_attitude,
                value = recall) %>% 
  tidyr::separate(warning_attitude,
                  into = c("warning", "attitude"),
                  remove = FALSE) %>% 
  dplyr::mutate(id = row_number()) %>% 
  dplyr::mutate_at(vars(id, warning_attitude, warning, attitude), factor) %>% 
  dplyr::select(id, warning_attitude, warning, attitude, recall)

data_memory_long
```


\clearpage

**DIRECTIONS:** Fit a two-way ANOVA model for the difference in mean `recall` for each of the combinations between the two-level `warning` factor and two-level `attitude` factor with the `afex::aov_4()` function and save the results under the name `aov_memory_2way`.


```{r Q14b8a_aov}
# Two-way ANOVA: fit and save

```


-----------------

**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above. 

```{r Q14b8a_aov_fuller}
# Display fuller ANOVA results (includes sum of squares)

```


\clearpage

### 14B-8b One-Way ANOVA: one 4 level factor

**TEXTBOOK QUESTION:** *(B) Compare your summary table to the one you produced for Exercise 12B8.*

> **NOTE:** We did not do Exercise 12B8, but we can do it here.

**DIRECTIONS:** Fit an one-way ANOVA model for the difference in mean `recall` for each of the four independent `warning_attitude` groups with the `afex::aov_4()` function and save the results under the name `aov_memory_1way`.


```{r Q14b8b_aov}
# One-way ANOVA: fit and save

```

-----------------------

**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above. 

```{r Q14b8b_aov_fuller}
# Display fuller ANOVA results (includes sum of squares)

```

-----------------------

### 14B-8c Plot Means to Aid Interpretation

**TEXTBOOK QUESTION:** * (C) What conclusions can you draw from the two-way ANOVA?*

```{r Q14b8c_means, results="asis"}
data_memory_long %>% 
  dplyr::group_by(warning_attitude) %>% 
  furniture::table1(recall,                 # gives M(SD)
                    output = "markdown")    # add chunk option: results="asis"
```





\clearpage

# SECTION C ITEMS

## Chapter 12. Effect Size and APA format


### 12C-1 Does Post-Quiz Heart Rate Differ by Difficulty Level?


**TEXTBOOK QUESTION:** *Perform a one-way ANOVA to test whether the different experimental conditions had a significant effect on postquiz heart rate. Request descriptive statistics and an HOV test. Calculate eta squared from your ANOVA output, and present your results in APA style.*


**DIRECTIONS:** Request the summary statistics for each group using the `table1()` function from the `furniture` package, after piping a `dplyr::group_by(group_var)` step.

```{r Q12c1_summary, results="asis"}
# Raw Data: summary table

```


------------------------------------------

**DIRECTIONS:** Plot the raw data for each group using the `stat_summary()` layer in `ggplot(aes(x = group_var, y = contin_var))`.

```{r Q12c1_plot, fig.height=2.75, fig.width=5}
# Raw data: plot M(SD)

```


\clearpage

**DIRECTIONS:** Use the `leveneTest()` function from the `car` package to test if the data give any evidence of a violation of *Homoegeity of Variance (HOV)*.  

> **NOTE:** We learned how to do this in [chapter 7](https://sarbearschwartz.github.io/Quant_I/t-test-for-the-difference-in-2-means-independent-samples.html#assumtion-check-homogeneity-of-variance)

```{r Q12c1_hov}
# Levene's Test of HOV
    
```

------------------------------------------

**DIRECTIONS:** Fit an one-way ANOVA model for the difference in mean `hr_post` for each of the three independent `exp_condF` groups *(make sure to use the factor version)* with the `afex::aov_4()` function and save the results under the name `aov_hr_post` for future use.

> **NOTE:** The identification variable is called `sub_num` in this dataset, not `id`.

```{r Q12c1_aov}
# One-way ANOVA: fit and save

```

------------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  

```{r Q12c1_aov_basic}
# Display basic ANOVA results (includes effect size)

```





\clearpage


### 12C-2a Do the Math and Stat Quiz Scores Differ by College Major?

**TEXTBOOK QUESTION:** *Using college major as the independent variable, perform a one-way ANOVA to test for significant differences in both mathquiz and statquiz . Request descriptive statistics and an HOV test. Based on the HOV test, for which DV should you consider performing an alternative ANOVA test? For whichever DV yields a p value between .05 and .1, report its results as a trend. For whichever DV yields a p value less than .05, calculate the corresponding value of eta squared, and report the ANOVA results, along with the means for the groups, in APA style.*

```{r Q12c2_summary, results="asis"}
# Raw Data: summary table
data_clean %>% 
  dplyr::group_by(majorF) %>% 
  furniture::table1(mathquiz, statquiz,     # gives M(SD)
                    output = "markdown")    # add chunk option: results="asis") 
```


\clearpage

**DIRECTIONS:** Plot the raw data for each group using the `stat_summary()` layer in `ggplot(aes(x = group_var, y = contin_var))`.  Do this TWICE, once with `y = mathquiz` and then again with `y = statquiz`.

```{r Q12c2_math_plot, fig.height=2.75, fig.width=5}
# Raw data: plot M(SD) - Math Quiz

```


```{r Q12c2_stat_plot, fig.height=2.75, fig.width=5}
# Raw data: plot M(SD) - Stat Quiz

```


\clearpage


#### Math Quiz - All Five Majors

**DIRECTIONS:** Use the `car::leveneTest()` to test for violations of *HOV*.  

```{r Q12c2_mathQ_hov}
# Levene's Test of HOV

```

----------------------------

**DIRECTIONS:** Fit an one-way ANOVA model using `afex::aov_4()`.

> **NOTE:** Because some of the students are missing the `mathquiz` variable,  you will need to preceed the `aov_4()` step with  `dplyr::filter(complete.cases(mathquiz, majorF))` in the pipeline.

```{r Q12c2_mathQ_aov}
# One-way ANOVA: fit and save

```


---------------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  

```{r Q12c2_mathQ_aov_basic}
# Display basic ANOVA results (includes effect size)

```



\clearpage


#### Stat Quiz - All Five Majors

**DIRECTIONS:** Use the `car::leveneTest()` to test for violations of *HOV*.  


```{r Q12c2_statQ_hov}
# Levene's Test of HOV

```

---------------------

**DIRECTIONS:** Fit an one-way ANOVA model using `afex::aov_4()`.

```{r Q12c2_statQ_aov}
# One-way ANOVA: fit and save

```

---------------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  

```{r Q12c2_statQ_aov_basic}
# Display basic ANOVA results (includes effect size)

```






\clearpage


### 12C-3 Remove Two Majors and Repeat 

#### Math Quiz - Only Three Majors

**TEXTBOOK QUESTION:** *Repeat Exercise 2 after using Select Cases to eliminate all of the psychology and premed students.*

> **NOTE:** You will need to preceed Levene's Test with `dplyr::filter(majorF %in% c("Biology", "Sociology", "Economics"))` in the pipeline in order to subset the data.


**DIRECTIONS:** Use the `car::leveneTest()` to test for violations of *HOV*.  

```{r Q12c3_math_hov}
# Levene's Test of HOV

```

--------------------------

**DIRECTIONS:** Fit an one-way ANOVA model using `afex::aov_4()`.

> **NOTE:**  Here you will need both the filter step for subsetting majors and the filter step to restrict to complete cases.  The order of the two `dplyr::filter()` steps does not matter.

```{r Q12c3_math_aov}
# One-way ANOVA: fit and display

```






\clearpage


#### Stat Quiz - Only Three Majors

**DIRECTIONS:** Use the `car::leveneTest()` to test for violations of *HOV*.  

> **NOTE:** You will need to preceed Levene's Test and the ANOVA with `dplyr::filter(majorF %in% c("Biology", "Sociology", "Economics"))` in the pipeline in order to subset the data.

```{r Q12c3_stat_hov}
# Levene's Test of HOV

```

--------------------------

**DIRECTIONS:** Fit an one-way ANOVA model using `afex::aov_4()`.

```{r Q12c3_stat_aov}
# One-way ANOVA: fit and display

```


\clearpage


### 12C-5 Phobia Group vs. Difference (Pre-Post) Heart Rate

**TEXTBOOK QUESTION:** *Use Recode to create a grouping variable from phobia , such that Group 1 contains those with phobia ratings of 0, 1, or 2; Group 2 = 3 or 4; and Group 3 = 5 or more (you might call the new variable Phob_group ). Then use Transform to create another new variable, hr_diff , that equals hr_pre minus hr_base . Perform a one-way ANOVA on hr_diff using Phob_group as the factor. Request descriptive statistics. Report the results in APA style, including the means of the three groups. Explain what this ANOVA demonstrates, in terms of the variables involved.*



```{r Q12c5_data}
data_new <- data_clean %>% 
  dplyr::mutate(phob_group = case_when(phobia <3            ~ 1,
                                       phobia %in% c(3, 4)  ~ 2,
                                       phobia >= 5          ~ 3)) %>% 
  dplyr::mutate(phob_group = factor(phob_group,
                                    levels = c(1, 2, 3),
                                    labels = c("Low", "Moderate", "High"))) %>% 
  dplyr::mutate(hr_diff = hr_pre - hr_base)  

```

\clearpage

**DIRECTIONS:** Request the summary statistics for each group using the `table1()` function from the `furniture` package, after piping a `dplyr::group_by(group_var)` step.

```{r Q12c5_summary, results='asis'}
# Raw data: summary table

```


-------------------------

**DIRECTIONS:** Use the `car::leveneTest()` to test for violations of *HOV*.  

```{r Q12c5_hov}
# Levene's Test of HOV

```

-------------------------

**DIRECTIONS:** Fit and save a one-way ANOVA model using `afex::aov_4()`.

```{r Q12c5_aov}
# One-way ANOVA: fit and save

```

-------------------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  

```{r Q12c5_aov_basic}
# Display basic ANOVA results (includes effect size)

```



\clearpage


## Chapter 13. Multiple Comparisons

### 13C-1a One-Way ANOVA: LSD and Tukey as Post Hoc tests

**TEXTBOOK QUESTION:** *(A) Redo the one-way ANOVA requested in exercise #1 in Section C of the previous chapter, selecting both LSD and Tukey as Post Hoc tests. For postquiz heart rate, which pairs of experimental conditions differ significantly from each other, according to each test? Can you justify using the results of the LSD test?* 

**DIRECTIONS:** Using the ANOVA model saved as `aov_hr_post` previously, request all pair wise post hoc comparisons, by first piping `emmeans::emmeans(~ group_var)` followed by `pairs(adjust = "none")` to utilize Fisher's LSD correction for multiple comparisons.


```{r Q13c1a_fisherlsd}
# Pairwise post hoc: Fisher's LSD adjustment for multiple comparisons

```

--------------------------------

**DIRECTIONS:** Repeat the above, but use `pairs(adjust = "tukey")` to utilize Tukey's HSD correction for multiple comparisons.

```{r Q13c1a_tukeyhsd}
# Pairwise post hoc: Tukey's HSD adjustment for multiple comparisons

```




\clearpage

### 13C-1c Contrast: Impossible vs. Others

**TEXTBOOK QUESTION:** *(C) Perform a contrast to compare the "impossible" condition with the other three for postquiz heart rate. How does the significance of this contrast compare to the one-way ANOVA? Explain. Looking at the means for the four conditions, design a contrast that you think would capture a large proportion of between-group variance.*


### Tutorial - Contrast Statements for One-way ANOVA models

There are two steps to conduct a contrast comparison:

1. `emmeans(~ group_var)` - Calculate the *Estimated Marinal Means*
2. `contrast()` - Determine if each pair is *significantly different*

Inside the contrast statement, list the named sets of linear contrast weights.  We will only be doing one-at-a-time, but we must still use a nested `list`.  

> **NOTE:** You must provide one weight ($c_i$) for each of the $k$ groups.  If you wish to ignore a group, that group's weight is $c_i = 0$.  The sum total of all the weights must be zero ($\sum c_i = 0$), so use positive and negative numbers.

```{r EX_contrast, eval=FALSE}
# Contrast statement : Impossible vs. Rest
aov_name %>% 
  emmeans::emmeans(~ group_var) %>% 
  emmeans::contrast(list("your contrast name" = c(c_1, c_2, ... , c_k)))
```


--------------------

**DIRECTIONS:** Using the sample recipe code chunk above as an outline, perform a contrast to compare the "impossible" condition with the other three for postquiz heart rate.

```{r Q13c1c_contrast}
# Contrast statement : Impossible vs. Rest

```

\clearpage

### 13C-2a Post Hoc Pairwise: Tukey and Bonferroni

**TEXTBOOK QUESTION:** *Redo the one-way ANOVA requested in Section C, exercise 2 of the previous chapter just for the mathquiz variable, selecting both Tukey and Bonferroni as Post Hoc tests in each case. Why is it problematic to use HSD with major as the factor in this dataset? Given the results of the post hoc tests, does the Tukey or Bonferroni test seem to have greater power when testing all possible pairs of means?*

**DIRECTIONS:** Fit an one-way ANOVA model for the difference in mean `mathquiz` for each `majorF` and save the results under the name `aov_math_major`.

```{r Q13c2a_aov}
# One-way ANOVA: fit and save

```

------------------------

**DIRECTIONS:** Request all pairwise post hoc comparisons TWICE, once via Tukey's HSD with the `adjust = "tukey"` option and a second time with `adjust = "bon"` within the `pairs()` function, applied after piping a `emmeans(~ group_var)` step to the ANOVA model.

```{r Q13c2a_tukey}
# Pairwise post hoc: Tukey's HSD adjustment for multiple comparisons

```

```{r Q13c2a_bon}
# Pairwise post hoc: Bonferroni adjustment for multiple comparisons

```





### 13C-2b Contrast: (Biology and Sociology) vs. other three majors

**TEXTBOOK QUESTION:** *Redo the one-way ANOVA requested in Section C, exercise 2 of the previous chapter just for the statquiz variable and request a contrast that compares the average of the Biology and Sociology majors to the average of the other three majors. Would this contrast be significant if it had been planned? Would this contrast be significant according to Scheffe's test?*

**DIRECTIONS:** Fit an one-way ANOVA model using `afex::aov_4()` and add via pipes both `emmeans::emmeans(~ group_var)` and `contrast()` with appropriate weights.


```{r Q13c2b_contrast}
# Contrast statement: Bio and Soc vs. rest

```


\clearpage




### 13C-4a One-Way ANOVA: prequiz anxiety by Phobia Group - LSD and Bonferroni

**TEXTBOOK QUESTION:** *Perform a one-way ANOVA on the prequiz anxiety measurement ( anx_pre ) using the grouping variable you created in Section C, exercise 5 of the previous chapter (based on phobia ratings). Select both LSD and Bonferroni as your post hoc tests. Which pairs differ significantly for each test?*

**DIRECTIONS:** Fit an one-way ANOVA model for the difference in mean `anx_pre` for each `phob_group` and save the results under the name `aov_anx_phob`.

```{r Q13c4a_aov}
# One-way ANOVA: fit and save

```


--------------------------

**DIRECTIONS:** Request all pairwise post hoc comparisons TWICE, once via Fisher's LSD with the `adjust = "none"` option and a second time with `adjust = "bon"` within the `pairs()` function, applied after piping a `emmeans(~ group_var)` step to the ANOVA model.


```{r Q13c4a_emmeans}
# Pairwise post hoc: Fisher's LSD adjustment for multiple comparisons

```


```{r Q13c4a_emmeans_bon}
# Pairwise post hoc: Bonferroni adjustment for multiple comparisons

```


\clearpage


### 13C-4b Contrast: Students (low or moderate) phobia vs. high

**TEXTBOOK QUESTION:** *Perform a contrast that compares students who had reported low or moderate phobia with those reporting high phobia. Calculate the effect size for this contrast. Is it small, medium, or large?*

**DIRECTIONS:** Starting with the previously fitted `aov_anx_phob` ANOVA model, add via pipes both `emmeans::emmeans(~ group_var)` and `contrast()` with appropriate weights.


```{r Q13c4b_contrast}
# Contrast statement: high vs. rest

```


\clearpage







## Chapter 14. Two-Way ANOVA


### 14C-1a 5x2 ANOVA: Major and Gender on Math Quiz

**TEXTBOOK QUESTION:** *Using college major and gender as your independent variables, perform a two-way ANOVA on mathquiz . Request descriptive statistics and an HOV test. Calculate the ordinary eta squared for each factor, and report your results in APA style.*

**DIRECTIONS:** Fit a two-way ANOVA model for the difference in mean `mathquiz` for each of the combinations between the five-level `majorF` factor and two-level `genderF` factor with the `afex::aov_4()` function and save the results under the name `aov_math_2way`.

```{r Q14c1a_aov}
# Two-way ANOVA: fit and save

```

-----------------------------

**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above. 


```{r Q14c1a_aov_fuller}
# Display fuller ANOVA results (includes sum of squares)

```


\clearpage


### 14C-1b Follow-up Comparisons: by major only

**TEXTBOOK QUESTION:** *Given the ANOVA results, perform an appropriate follow-up test. Explain your results in terms of the descriptive statistics.*

**DIRECTIONS:** Request the summary statistics for each group using the `table1()` function from the `furniture` package, after piping a `dplyr::group_by(group_var)` step.

```{r Q14c1b_summary, results='asis'}
# Raw data: summary table

```


-----------------------------------


**DIRECTIONS:** Fit an one-way ANOVA model using `afex::aov_4()`.  Add on via pipes both `emmeans::emmeans(~ group_var)` and `pairs()`.  Make sure to indicate `adjust = "tukey"` wintin the pairs command.


```{r Q14c1b_tukey}                     
# One-way ANOVA: fit and pairwise with Tukey's HSD

```

\clearpage


### 14C-4a 2x3 ANOVA: Phobia Group and Gender on Math Quiz

**TEXTBOOK QUESTION:** *Using the phobia grouping variable you cre4. ated for computer exercise 5 in Chapter 12 and gender as your IVs, perform a two-way ANOVA on mathquiz . Request the appropriate post hoc test and a plot of the cell means, and report the results in APA style.*

**DIRECTIONS:** Plot the raw data for each group using the `stat_summary()` layer in `ggplot(aes(x = group_var1, y = contin_var))`.  Utilize the `shape` and `color` options for `group_var2`.  Also consider dodging the position of the groups to avoid overplotting.

```{r Q14c4a_plot}
# Raw data: plot M(SD)

```


------------------------------------------

Here is the 2x3 grid of cell means, giving the average for each of the 6 combinations of `genderF` and `phob_group`.


```{r Q14c4a_means}
# Raw data: 2-way table of means (i.e. cell means)
data_new %>% 
  dplyr::group_by(phob_group, genderF) %>% 
  dplyr::summarise(mean = mean(mathquiz, na.rm = TRUE)) %>% 
  tidyr::spread(key = phob_group, 
                value = mean)
```

\clearpage

**DIRECTIONS:** Fit a two-way ANOVA model for the difference in mean `mathquiz` for each of the combinations between the five-level `phob_group` factor and two-level `genderF` factor with the `afex::aov_4()` function and save the results under the name `aov_math_phob_gender`.


```{r Q14c4a_aov}
# Two-way ANOVA: fit and save
 
```


-----------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  

```{r Q14c4a_aov_basic}
# Display basic ANOVA results (includes effect size)

```


---------------------

**DIRECTIONS:** Request all pairwise post hoc comparisons via Fisher's LSD with the `adjust = "none"` option in the `pairs()` function, applied after piping a `emmeans(~ group_var)` step to the ANOVA model above.


```{r Q14c4a_fisherlsd}
# Pairwise post hoc: Fisher's LSD adjustment for multiple comparisons

```


\clearpage



### 14C-4b Repeat without the Moderate Group

**TEXTBOOK QUESTION:** *Repeat part a (except for the post hoc test) after deleting the moderate phobia group from the analysis. What type of interaction do you see in the plot? Test the simple main effect of phobia for each gender. Do you need to follow up any of the simple main effects with pairwise comparisons? Explain.*


**DIRECTIONS:** Repeat the previous ANOVA model, but preceed it by a `dplyr::filter(phob_group != "Moderate")` step in the pipeline and save the results under the name `aov_math_phob2_gender`.


```{r Q14c4b_aov}
# Two-way ANOVA: fit and save

```


--------------------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above.  

```{r Q14c4b_aov_basic}
# Display basic ANOVA results (includes effect size)
 
```



\clearpage


### 14C-5a 2x3 ANOVA: Coffee Drinking and Phobia Group on Post Quiz Heart Rate

**TEXTBOOK QUESTION:** *Using the phobia grouping variable you created for computer exercise #5 in Chapter 12 (do not drop any phobia groups for this exercise) and coffee (regular coffee drinker or not) as your IVs, perform a two-way ANOVA on the postquiz heart rate. Request an HOV test, observed power, and a plot of the cell means. (A) Does the HOV test give you cause for concern? Explain the ANOVA results in terms of the plot you created.*

Here is the 2x3 grid of cell means, giving the average for each of the 6 combinations of `coffeeF` and `phob_group`.


```{r Q14c5a_means}
# Raw data: 2-way table of means (i.e. cell means)
data_new %>% 
  dplyr::group_by(coffeeF, phob_group) %>% 
  dplyr::summarise(mean = mean(hr_post)) %>% 
  tidyr::spread(key = phob_group,
                value = mean)
```

------------------------

**DIRECTIONS:** Plot the raw data for each group using the `stat_summary()` layer in `ggplot(aes(x = group_var1, y = contin_var))`.  Utilize the `shape` and `color` options for `group_var2`.  Also consider dodging the position of the groups to avoid overplotting.

```{r Q14c5a_boxplots}
# Raw data: plot M(SD)'s
 
```


\clearpage


**DIRECTIONS:** Use the `car::leveneTest()` to test for violations of *HOV*. Since this is a two-way ANOVA situation, be sure to include the correct formula: `contin_var = group_var1*group_var2`. 

```{r Q14c5a_hov}
# Levene's Test of HOV
 
```

---------------------

**DIRECTIONS:** Fit a two-way ANOVA model for the difference in mean `hr_post` for each of the combinations between the five-level `phob_group` factor and two-level `coffeeF` factor with the `afex::aov_4()` function and save the results under the name `aov_hrpost_phob_coffee`.

```{r Q14c5a_aov}
# Two-way ANOVA: fit and save

```

--------------------------

**DIRECTIONS:** Request the $F$ value by typing the name you saved your fitted model as above. 

```{r Q14c5a_aov_basic}
# Display basic ANOVA results (includes effect size)

```


\clearpage


### 14C-5b Follow-up Comparisons

**TEXTBOOK QUESTION:** *Request an appropriate post hoc test to follow-up your ANOVA results, and report the results. Calculate the ordinary eta squared for each main effect; how large is each effect? ~~Does the observed power make sense in each case?~~*

**DIRECTIONS:** Request the more complete summary table by adding `$Anova` at the end of the name you saved your fitted model as above. 

```{r Q14c5b_aov_fuller}
# Display fuller ANOVA results (includes sum of squares)

```


-----------------------

**DIRECTIONS:** Request all pairwise post hoc comparisons with the `pairs()` function, applied after piping a `emmeans(~ group_var)` step to the ANOVA model. Only do this for significant main effects with at least three factor levels.


```{r}

```


**Do NOT worry about observed power!**












\clearpage

# SECTION B ITEMS


## Chapter 9. Linear Correlation


### 9B-5 Calculating Pearson's $r$

**TEXTBOOK QUESTION:** *A psychiatrist has noticed that the schizophrenics who have been in the hospital the longest score the lowest on a mental orientation test. The data for 10 schizophrenics are listed in the following table.  (a) Calculate Pearson’s $r$ for the data. (b) Test for statistical significance at the .05 level (two-tailed).*


```{r Q9b5}
schizo
```


**DIRECTIONS:** Calculate Pearson's $r$ between `yr_hos` and `ori_test` in the `schizo` dataset.  Also, test against the two-sided alternative.

The `cor.test()` function needs at least two arguments:

1. the formula:  `~ continuous_var1 + continuous_var2`
2. the dataset: `data = .` *we use the period to signify that the datset is being piped from above*

> **NOTE:** The `cor.test()` function computes the Pearson correlation coefficient by default (`method = "pearson"`), but you may also specify the Kendall (`method = "kendall"`)or Spearman (`method = "spearman"`)methods.  It also defauls to testing for the two-sided alternative and computing a 95\% confidence interval (`conf.level = 0.95`).  You will not need to change these options in this assignment.



```{r Q9b5a}
# Pearson's r: yr_hos & ori_test


```




\clearpage


### 9B-6 One vs. Two Sided Alternative


**TEXTBOOK QUESTION:** *If a test is reliable, each participant will tend to get the same score each time he or she takes the test. Therefore, the correlation between two administrations of the test (test-retest reliability) should be high. The reliability of the verbal GRE score was tested using five participants, as shown below. (a) Calculate Pearson’s r for the test-retest reliability of the verbal GRE score. (b) Test the significance of this correlation with $\alpha = .05$ (one-tailed). Would this correlation be significant with a twotailed test?*

```{r Q9b6}
GRE
```


**DIRECTIONS:** Calculate Pearson's $r$ between `verbalGRE_1`and `verbalGRE_2` in the `GRE` dataset TWICE.  The first time test for the **one-sided** alternative and the second time for the **two-sided** alternative.

The `cor.test()` function defaults to the `alternative = "two.sided"`.  If you would like a one-sided alternative, you must choose which side you would like to test:  `alternative = "greater"` or `alternative = "less"`


```{r Q9b6a}
# Pearson's r: verbalGRE_1 & verbalGRE_2 --> ONE tail


```



```{r Q9b6b}
# Pearson's r: verbalGRE_1 & verbalGRE_2 --> TWO tails


```




\clearpage


## Chapter 10. Linear Regression

### 10B-6 Swapping x and y

**TEXTBOOK QUESTION:** *A cognitive psychologist is interested in the relationship between spatial ability (e.g., ability to rotate objects mentally) and mathematical ability, so she measures 12 participants on both variables. The data appear in the following table.  (a) Find the regression equation for predicting the math score from the spatial ability score. (b)  Find the regression equation for predicting the spatial ability score from the math score. (c) According to your answer to part a, what math score is predicted from a spatial ability score of 20? (d) According to your answer to part b, what spatial ability score is predicted from a math score of 20?*

```{r Q10b6}
test_scores
```


**DIRECTIONS:** Use the `lm()` function to fit a linear model or linear regression model TWICE for `math` and `spacial` in the `test_scores` dataset, specifing which is x and which is y.


The `lm()` function needs at least two arguments:

1. the formula:  `continuous_y ~ continuous_x`
2. the dataset: `data = .` *we use the period to signify that the datset is being piped from above*

> **NOTE:** To view more complete information, add a `summary()` step using a pipe AFTER the `lm()` step


```{r Q10b6a}
# Linear model: y = math & x = spatial


```


```{r Q10b6b}
# Linear model: y = spatial & x = math


```



\clearpage

### 10B-9 Predictions and Residuals


**TEXTBOOK QUESTION:** *If you calculate the correlation between shoe size and reading level in a group of elementary school children, the correlation will turn out to be quite large, provided that you have a large range of ages in your sample. The fact that each variable is correlated with age means that they will be somewhat correlated with each other. The following table illustrates this point. Shoe size is measured in inches, for this example, reading level is by grade (4.0 is average for the fourth grade), and age is measured in years. (a) Find the regression equation for predicting shoe size from age. (b) Find the regression equation for predicting reading level from age. (c) Use the equations from parts a and b to make shoe size and reading level predictions for each child. Subtract each prediction from its actual value to find the residual.*

```{r Q10b9}
child_vars
```



**DIRECTIONS:** Use the `lm()` function to fit a linear model or linear regression model TWICE for `shoe` and `read` each perdicited in turn by `age` in the `child_vars` dataset, specifing which is x and which is y.


```{r Q10b9a}
# Linear model: y = shoe & x = age


```


\clearpage

```{r Q10b9b}
# Linear model: y = read & x = age


```

------------------------------

**DIRECTIONS:** Starting with the `child_vars` dataset, create four new variables, each with a seperate `dplyr::mutate()` function step.  Pipe it all together ans save it as new dataset with the `child_new <-` assignment operator to use in the next step.

1. `shoe_pred` Use the appropriate regression equation
2. `shoe_resid` Subtract:  `shoe` (the original) minus `shoe_resid` (the residual)
3. `read_pred` Use the appropriate regression equation
4. `read_resid` Subtract:  `read` (the original) minus `read_resid` (the residual)

```{r Q10b9c}
# create new variables --> save as: child_new 


```

> **Note:** Remove the hashtag symbol at the first of the code line below to show your new variables.

```{r Q10b9d}
#child_new 
```




\clearpage

### 10B-10 Raw Correlation vs. Partial Correlation


**TEXTBOOK QUESTION:** *(a) Calculate Pearson’s r for shoe size and reading level using the data from Exercise 9.  (b) Calculate Pearson’s r for the two sets of residuals you found in part c of Exercise 9. (c) Compare your answer in part b with your answer to part a. The correlation in part b is the partial correlation between shoe size and reading level after the confounding effect of age has been removed from each variable (see Chapter 17 for a much easier way to obtain partial correlations).*

-------------------------------

**DIRECTIONS:** Calculate Pearson's $r$ between `shoe`and `read` in the `child_new` dataset.  


```{r Q10b10}
# Pearson's r: shoe & read

```


-------------------------------

**DIRECTIONS:** Calculate Pearson's $r$ between `shoe_resid`and `read_resid` in the `child_new` dataset.  

```{r Q10b10a}
# Pearson's r: shoe_resid & read_resid

```



\clearpage


## Chapter 11. Matched pairs t-test


### 11B-3 Matched Pairs vs. Direct Difference Methods


**TEXTBOOK QUESTION:** *Using the data from Exercise 9B6, which follows.  (a) Determine whether there is a significant tendency for verbal GRE scores to improve on the second testing. Calculate the matched t in terms of the Pearson correlation coefficient already calculated for that exercise. (b) Recalculate the matched t test according to the direct-difference method and compare the result to your answer for part a.*

```{r Q11b3}
GRE
```



**DIRECTIONS:** Calculate the matched pairs t test between `verbalGRE_1`and `verbalGRE_2` in the `GRE` dataset. 

In order to use this function, you MUST first restructure your dataset so that the TWO continous variables are stacked or **gathered** together.  Use the `tidyr::gather()` function with the following FOUR options:

  * A new variable name that will store the original variable names:  `key = new_group_var`
  * A new variable name that will store the original variable values: `value = new_continuous_var`
  * List the original variable names:  `continous_var1, continuous_var2`
  * Do not get ride of blank values:  `na.rm = FALSE`

After the dataset is fathered, ad the `t.test()` function, which needs at least THREE arguments:

  * the formula:  `continuous_var ~ group_var`
  * the dataset: `data = .` *we use the period to signify that the datset is being piped from above*
  * specify the data is paired: `paired = TRUE` *the default is independent groups*
  
> **Note:** I suggest using `key = time` and `value = verbalGRE`.


```{r Q11b3a}
# Paired t-test: verbalGRE1 & verbalGRE2

```

\clearpage

-----------------------

**DIRECTIONS:** Calculate a NEW variable called `verbalGRE_diff` with the `dplyr::mutate()` function by subtracting the `verbalGRE_1`and `verbalGRE_2` variables in the `GRE` dataset. Pipe it all together ans save it as new dataset with the `GRE_new <-` assignment operator to use in the next step.


```{r Q11b3b}
# Compute a new variable --> save as: child_new

```

> **Note:** Remove the hashtag symbol at the first of the code line below to show your new variables.

```{r Q11b3c}
# GRE_new
```


> **Note:** Remember that before you do a one-sample t test for the mean, you have to use the `dplyr::pull()` function (see chapter 6)

```{r Q11b3d}
# 1-sample t test: pop mean of verbalGRE_diff = 0 (no difference)

```



\clearpage

### 11B-8 Confidence Intervale for the Mean Difference


**TEXTBOOK QUESTION:** *A cognitive psychologist is testing the theory that short-term memory is mediated by subvocal rehearsal. This theory can be tested by reading aloud a string of letters to a participant, who must repeat the string correctly after a brief delay. If the theory is correct, there will be more errors when the list contains letters that sound alike (e.g., G and T) than when the list contains letters that look alike (e.g., P and R). Each participant gets both types of letter strings, which are randomly mixed in the same experimental session. The number of errors for each type of letter string for each participant are shown in the following table. (a) Perform a matched t test ( $\alpha = .05$, one tailed) on the data above and state your conclusions.  (b) Find the 95% confidence interval for the population difference for the two types of letters.*

```{r Q11b8}
memory
```

**DIRECTIONS:** Calculate the matched pairs t test between `sound`and `look` in the `memory` dataset twice: first as a **one-tail** test and then again as a **two-tailed*** test.

> **Note:** I suggest using `key = type` and `value = errors`.

```{r Q11b8a}
# Paired t-test: sound and look --> ONE tail
 
```

\clearpage



```{r Q11b8b}
# Paired t-test: sound and look --> TWO tails
 
```




\clearpage

### 11B-9 t-Test for Mean Difference vs. Correlation

**TEXTBOOK QUESTION:** *For the data in Exercise 10B6: (a) Calculate the matched t value to test whether there is a significant difference ($\alpha = .05$, two tailed) between the spatial ability and math scores. Use the correlation coefficient you calculated to find the regression slope in Exercise 10B6. (b) Explain how the Pearson r for paired data can be very high and statistically significant, while the matched t test for the same data fails to attain significance.*


```{r Q11b9}
test_scores
```

**DIRECTIONS:** Calculate Pearson's $r$ between `spatial` and `math` in the `schizo` test_scores 


```{r Q11b9a}
# Pearson's r: spatial & math

```


\clearpage

> **Note:** I suggest using `key = type` and `value = score`.

```{r Q11b9b}
# Paired t-test: spatial & math 

```





\clearpage

# SECTION C ITEMS

## Chapter 9. Linear Correlation

### 9C-1. Scatterplots - Eyeball method for estimating correlation

**TEXTBOOK QUESTION:** *(A) Create a scatter plot of phobia versus statquiz. From looking at the plot, do you think the Pearson’s r will be positive or negative? Large, medium, or small? (B) Create a scatter plot of baseline anxiety versus postquiz anxiety. From looking at the plot, do you think the Pearson’s r will be positive or negative? Large, medium, or small?*

-------------------------------

**DIRECTIONS:** Create two scatter plots: the first with `phobia` on the horizontal axis (`x`) and `statquiz` on the vertical axis (`y`) and the second with `anx_base` on the x-axis and `anx_post` on the y-axis.  Then answer the rest of the question in the printed homework packet.  

> **NOTE:** You may use the `geom_count()` funciton instead of the `geom_point()` function due to the high number of points that are 'over plotted' or on top of each other, since the two measures are quite coursely captured.

```{r Q9c1a}
# Scatterplot: phobia vs. statquiz

```


\clearpage

```{r Q9c1b}
# Scatterplot: anx_base vs. anx_post

```


\clearpage

### 9C-2a. Calculating Pearson's $r$

**TEXTBOOK QUESTION:** *Compute the Pearson’s $r$ between `phobia` and `statquiz` for all students; also, find the Pearson’s $r$ between baseline and postquiz anxiety.*

-------------------------------

**DIRECTIONS:** Compute Pearson's $r$: first for `phobia` and `statquiz`, followed by `anx_base` and `anx_post` using the `cor.test()` function.



```{r Q9c2a1}
# Pearson's r: phobia & statquiz

```

```{r Q9c2a2}
# Pearson's r: anx_base & anx_post

```


\clearpage

### 9C-2b. Effect of Excluding Extreme Values


**TEXTBOOK QUESTION:** *Use Select Cases to delete any student whose baseline anxiety is over 29, and repeat part (B) of the first exercise. Also, rerun the correlation of baseline and postquiz anxiety. What happened to the Pearson’s r ? Use the change in the scatter plot to explain the change in the correlation coefficient.*

-------------------------------

**DIRECTIONS:** Create a scatterplot for `anx_base` and `anx_post`, AFTER first using a `dplyr::filter()` funtion in a prepatroy step to restrict to the subsample of students with baseline anxiety of 29 and below.


```{r Q9c2b1}
# Scatterplot: anx_base vs. anx_post <-- restricting to baseline anxiety of 29 and lower

```


\clearpage

-------------------------------

**DIRECTIONS:** Compute Pearson's $r$: for `anx_base` and `anx_post`, AFTER first using a `dplyr::filter()` funtion in a prepatroy step to restrict to the subsample of students with baseline anxiety of 29 and below.

```{r Q9c2b2}
# Pearson's r: anx_base & anx_post <-- restricting to baseline anxiety of 29 and lower

```





### 9C-3. Reporting APA Style 

**TEXTBOOK QUESTION:** *(a) Compute Pearson’s $r$'s among the three measures of anxiety. Write up the results in APA style. (b) Compute the average of the three measures of anxiety, and then compute the correlation between each measure of anxiety and the average, ~~so that the output contains a single column of correlations (do this by creating and appropriately modifying a syntax file~~).*

-------------------------------


**DIRECTIONS:** First, compute a new variable called `anx_mean` that is the average of all three of the anxiety measures using the `furniture::rowmeans()` function. Then use the `furniture::tableC()`function to create a correlation matrix for all FOUR anxiety meausres.

```{r Q9c3}
# Pearson's r: anx_mean, anx_base, anx_pre, & anx_post

```



\clearpage

### 9C-4. Missing Values

**TEXTBOOK QUESTION:** *(a) Compute Pearson’s $r$ for the following list of variables: mathquiz , statquiz , and phobia . (b) Repeat part a after selecting exclude cases listwise. Which correlation was changed? Explain why.*

-------------------------------

**Directions:** Compute the correlation matrix between `mathquiz`, `statquiz`, and `phobia` using the `furniture::tableC()` function two times; first with all defaults and again with listwise deletion.


> **Note:** The `furniture::tableC()` funtion defaults to `na.rm = FALSE` which displays `NA` for any correlation between a pair of variables where even one subject is missing one value.  To use listwise deletion, specify the option `na.rm = TRUE`.

```{r Q9c4a}
# Pearson's r: (default: na.rm = FALSE)

```



```{r Q9c4b}
# Pearson's r: "complete.obs" (list-wise deletion)

```




\clearpage


## Chapter 10. Linear Regression


### 10C-1. Linear Regression

**TEXTBOOK QUESTION:** *Perform a linear regression to predict statquiz from phobia, and write out the raw-score regression formula. Do the slope and Y intercept differ significantly from zero? Explain how you know. What stats quiz score would be predicted for a student with a phobia rating of 9? Approximately what phobia rating would a student need to have in order for her predicted statquiz score to be 7.2?*

-------------------------------

**Directions:**  Use the `lm()` function to fit a linear model or linear regression model predicting `statquiz` from `phobia`.

```{r Q10c1}
# Linear model: y = statquiz & x = phobia

```





\clearpage

### 10C-2. Subgroups Analysis

**TEXTBOOK QUESTION:** *(a) Perform a linear regression to predict pre-quiz anxiety from phobia, and write out the raw-score regression formula. (b) Repeat part a separately for men and women. For each gender, what prequiz anxiety rating would be predicted for someone reporting a phobia rating of 8? For which gender should you really not be making predictions at all? Explain.*

-------------------------------

**Directions:** Use the `lm()` function to fit a linear model or linear regression model predicting `anx_pre` from `phobia`. Then repeat the same model TWICE more: first among just men and then for just women.


> **Note:** Use the `dplyr::filter()` function to subset the sample BEFORE fitting the model.  Also, be aware of which type of variable you are using:  `genderF == "Male"` or `gender == 2` works, but `gender == male` does NOT.


```{r Q10c2a}
# Linear model: y = anx_pre & x = phobia  <-- full sample

```


\clearpage


```{r Q10c2b}
# Linear model: y = anx_pre & x = phobia  <-- subset of men

```


```{r Q10c2c}
# Linear model: y = anx_pre & x = phobia  <-- subset of women

```








