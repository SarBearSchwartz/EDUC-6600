<!DOCTYPE html>
<html>
  <head>
    <title>Linear Regression</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="pres3.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Linear Regression
## Cohen Chapter 9 <br><br> .small[EDUC/PSY 6600]

---




class: center, middle

## "Statistics is not a discipline like physics, chemistry, or biology where we study a subject to solve problems in the same subject. &lt;br&gt; We study statistics with the main aim of solving problems in other disciplines."

### -- C.R. Rao, Ph.D. 

---
# Motivating Example

.large[
- Dr. Mortimer is interested in knowing whether people who have a positive view of themselves in one aspect of their lives also tend to have a positive view of themselves in other aspects of their lives. 
- He has 80 men complete a self-concept inventory that contains 5 scales. Four scales involve questions about how competent respondents feel in the areas of intimate relationships, relationships with friends, common sense reasoning and everyday knowledge, and academic reasoning and scholarly knowledge. 
- The 5th scale includes items about how competent a person feels in general. 
- 10 correlations are computed between all possible pairs of variables.
]

---
# Correlation

.pull-left[
.large[
- .dcoral[Interested in **degree** of covariation or co-relation among &gt;1 variables measured on SAME objects/participants]
    - Not interested in group differences, per se
- Variable measurements have:
    - Order: Correlation
    - No order: Association or dependence
]]

--

.pull-right[.large[
- Level of measurement for each variable determines type of correlation coefficient
- Data can be in raw or standardized format
- Correlation coefficient is .nicegreen[scale-invariant]
- .bluer[Statistical significance] of correlation
    - `\(H_0\)`: population correlation coefficient = 0
]]

---
background-image: url(figures/fig_spurious.jpeg)
background-position: 50% 50%
background-size: 1200px


.footnote[http://www.tylervigen.com/spurious-correlations]

---
# Always **Visualize** Data First

### Scatterplots



.pull-left[

*Aka: scatterdiagrams, scattergrams*

Notes:
1. Can stratify scatterplots by subgroups
2. Each subject is represented by 1 dot (x and y coordinate)
3. Fit line can indicate nature and degree of relationship (Regression or prediction lines)



```r
library(tidyverse)
df %&gt;%
  ggplot(aes(x, y)) +
    geom_point() +
    geom_smooth(se = FALSE,
                method = "lm")
```
]

.pull-right[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Correlation: Direction

.pull-left[.center[
#### .nicegreen[Positive Association]
.large[
**High values** of one variable tend to occur with **High values** of the other
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /&gt;
]]]

.pull-right[.center[
#### .bluer[Negative Association]
.large[
**High values** of one variable tend to occur with **Low values** of the other
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;
]]]


---
# Correlation: Strength

The strength of the relationship between the two variables can be seen by how much variation, or scatter, there is around the main form.

- With a strong relationship, you can get a pretty good estimate of y if you know x.
- With a weak relationship, for any x you might get a wide range of  y values.

--



.pull-left[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Scatterplot Patterns



.pull-left[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /&gt;
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;
]


---
# Predictability

The ability to predict `y` based on `x` is another indication of correlation strength:

.pull-left[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-15-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Scatterplot: Scale

.pull-left[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;
&lt;img src="u03_Ch9_LinReg_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;
]

Note: all have the same data! Also, `ggplot2`'s defaults are usually pretty good

---
class: inverse, center, middle

# Let's Apply This to the Cancer Dataset 


---
# Read in the Data


```r
library(tidyverse)    # Loads several very helpful 'tidy' packages
library(haven)        # Read in SPSS datasets
library(psych)        # Lots of nice tid-bits
library(car)          # Companion to "Applied Regression"
```


```r
cancer_raw &lt;- haven::read_spss("cancer.sav")
```



### And Clean It


```r
cancer_clean &lt;- cancer_raw %&gt;% 
  dplyr::rename_all(tolower) %&gt;% 
  dplyr::mutate(id = factor(id)) %&gt;% 
  dplyr::mutate(trt = factor(trt,
                             labels = c("Placebo", 
                                        "Aloe Juice"))) %&gt;% 
  dplyr::mutate(stage = factor(stage))
```




---
# 1 sample t Test vs. Historic Control

Do the patients weigh more than 165 pounds at intake, on average?


```r
cancer_clean %&gt;% 
  dplyr::pull(weighin) %&gt;% 
  t.test(mu = 165)
```

```

	One Sample t-test

data:  .
t = 2.0765, df = 24, p-value = 0.04872
alternative hypothesis: true mean is not equal to 165
95 percent confidence interval:
 165.0807 191.4793
sample estimates:
mean of x 
   178.28 
```



---
## ...Change the Confidence Level

Find a .dcoral[99%] confience level for the population mean weight.


```r
cancer_clean %&gt;% 
  dplyr::pull(weighin) %&gt;% 
  t.test(mu = 165,
         conf.level = 0.99)
```

```

	One Sample t-test

data:  .
t = 2.0765, df = 24, p-value = 0.04872
alternative hypothesis: true mean is not equal to 165
99 percent confidence interval:
 160.3927 196.1673
sample estimates:
mean of x 
   178.28 
```



---
## ...Restrict to a Subsample

Do the patients with .dcoral[stage 3 &amp; 4] cancer weigh more than 165 pounds at intake, on average?


```r
cancer_clean %&gt;% 
  dplyr::filter(stage %in% c("3", "4")) %&gt;% 
  dplyr::pull(weighin) %&gt;% 
  t.test(mu = 165)
```

```

	One Sample t-test

data:  .
t = 0.82627, df = 5, p-value = 0.4463
alternative hypothesis: true mean is not equal to 165
95 percent confidence interval:
 137.0283 219.4717
sample estimates:
mean of x 
   178.25 
```






---
class: inverse, center, middle

# Questions?


---
class: inverse, center, middle

# Next Topic

### Independent Samples t Tests for Means
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});
(function() {var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler"); if (!r) return; s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }"; d.head.appendChild(s);})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
